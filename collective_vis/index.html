<html lang="en-GB" class=" grunticon no-js svg"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    Covid-19 effects on the poorest 20% of people worldwide
  </title>



<link href="https://devinit.org/assets/css/screen.min.600391bdde7f.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" rel="stylesheet">
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script>/*! grunt-grunticon Stylesheet Loader - v2.1.6 | https://github.com/filamentgroup/grunticon | (c) 2015 Scott Jehl, Filament Group, Inc. | MIT license. */
!function(){function e(e,n,t){"use strict";var o=window.document.createElement("link"),r=n||window.document.getElementsByTagName("script")[0],a=window.document.styleSheets;return o.rel="stylesheet",o.href=e,o.media="only x",r.parentNode.insertBefore(o,r),o.onloadcssdefined=function(e){for(var n,t=0;t<a.length;t++)a[t].href&&a[t].href===o.href&&(n=!0);n?e():setTimeout(function(){o.onloadcssdefined(e)})},o.onloadcssdefined(function(){o.media=t||"all"}),o}function n(e,n){e.onload=function(){e.onload=null,n&&n.call(e)},"isApplicationInstalled"in navigator&&"onloadcssdefined"in e&&e.onloadcssdefined(n)}!function(t){var o=function(r,a){"use strict";if(r&&3===r.length){var i=t.navigator,c=t.document,s=t.Image,d=!(!c.createElementNS||!c.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||!c.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")||t.opera&&-1===i.userAgent.indexOf("Chrome")||-1!==i.userAgent.indexOf("Series40")),l=new s;l.onerror=function(){o.method="png",o.href=r[2],e(r[2])},l.onload=function(){var t=1===l.width&&1===l.height,i=r[t&&d?0:t?1:2];t&&d?o.method="svg":t?o.method="datapng":o.method="png",o.href=i,n(e(i),a)},l.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",c.documentElement.className+=" grunticon"}};o.loadCSS=e,o.onloadCSS=n,t.grunticon=o}(this),function(e,n){"use strict";var t=n.document,o="grunticon:",r=function(e){if(t.attachEvent?"complete"===t.readyState:"loading"!==t.readyState)e();else{var n=!1;t.addEventListener("readystatechange",function(){n||(n=!0,e())},!1)}},a=function(e){return n.document.querySelector('link[href$="'+e+'"]')},i=function(e){var n,t,r,a,i,c,s={};if(n=e.sheet,!n)return s;t=n.cssRules?n.cssRules:n.rules;for(var d=0;d<t.length;d++)r=t[d].cssText,a=o+t[d].selectorText,i=r.split(");")[0].match(/US\-ASCII\,([^"']+)/),i&&i[1]&&(c=decodeURIComponent(i[1]),s[a]=c);return s},c=function(e){var n,r,a,i;a="data-grunticon-embed";for(var c in e){i=c.slice(o.length);try{n=t.querySelectorAll(i)}catch(s){continue}r=[];for(var d=0;d<n.length;d++)null!==n[d].getAttribute(a)&&r.push(n[d]);if(r.length)for(d=0;d<r.length;d++)r[d].innerHTML=e[c],r[d].style.backgroundImage="none",r[d].removeAttribute(a)}return r},s=function(n){"svg"===e.method&&r(function(){c(i(a(e.href))),"function"==typeof n&&n()})};e.embedIcons=c,e.getCSS=a,e.getIcons=i,e.ready=r,e.svgLoadedCallback=s,e.embedSVG=s}(grunticon,this)}();
	grunticon(["https://devinit.org/assets/icons/ico.data.svg.5b91ad25605f.css", "https://devinit.org/assets/icons/ico.data.png.f32b31c4bf32.css", "https://devinit.org/assets/icons/ico.fallback.4e2c768f487b.css"]);
</script>
<noscript><link href="https://devinit.org/assets/icons/ico.fallback.4e2c768f487b.css" rel="stylesheet"></noscript>
<script src="https://devinit.org/assets/js/libs/modernizr.30c0023fa2cd.js"></script>


<link rel="icon" type="image/png" href="https://devinit.org/assets/favicons/favicon.85ce05716b7b.png" sizes="16x16">

<link href="https://devinit.org/assets/css/di_website.cebbdc3a54c7.css" rel="stylesheet">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Covid-19 effects on the poorest 20% of people worldwide — Development Initiatives">
<meta name="twitter:description" content="Covid-19 effects on the poorest 20% of people worldwide">
<meta name="twitter:image" content="https://devinit.org/media/images/Hero_image_Community_Case_Management_in_Banglad.original.jpg">



<meta property="og:title" content="Covid-19 effects on the poorest 20% of people worldwide">
<meta property="og:description" content="Covid-19 effects on the poorest 20% of people worldwide">
<meta property="og:site_name" content="Development Initiatives">
<meta property="og:image" content="https://devinit.org/media/images/Hero_image_Community_Case_Management_in_Banglad.original.jpg">



<meta itemprop="name" content="Covid-19 effects on the poorest 20% of people worldwide — Development Initiatives">
<meta itemprop="description" content="Covid-19 effects on the poorest 20% of people worldwide">
<meta itemprop="image" content="https://devinit.org/media/images/Hero_image_Community_Case_Management_in_Banglad.original.jpg">

<meta name="description" content="Covid-19 effects on the poorest 20% of people worldwide">


<!-- Custom CSS -->
<style>
  .myYaxis1 .domain {opacity: 0;}
  .myYaxis2 .domain {opacity: 0;}
  .myYaxis3 .domain {opacity: 0;}
  .myYaxis1 .tick line {opacity: 0;}
  .myYaxis2 .tick line {opacity: 0;}
  .myYaxis3 .tick line {opacity: 0;}
  .myXaxis1 .domain {stroke: #443e42;}
  .myXaxis2 .domain {stroke: #443e42;}
  .myXaxis3 .domain {stroke: #443e42;}
  .myXaxis1 .tick line {opacity: 0;}
  .myXaxis2 .tick line {opacity: 0;}
  .myXaxis3 .tick line {opacity: 0;}
  .yGrid1 .domain {opacity: 0;}
  .yGrid2 .domain {opacity: 0;}
  .yGrid3 .domain {opacity: 0;}
  .yGrid1 .tick line {stroke: #a9a6aa;}
  .yGrid2 .tick line {stroke: #a9a6aa;}
  .yGrid3 .tick line {stroke: #a9a6aa;}
  .yGrid1 .tick:first-of-type {opacity: 0;}
  .yGrid2 .tick:first-of-type {opacity: 0;}
  .yGrid3 .tick:first-of-type {opacity: 0;}
  .tick text {fill: #a9a6aa;}
  .axis-title {fill: #443e42;}
  .tooltip1 {font-size: 14px;}
  .tooltip2 {font-size: 14px;}
  .tooltip3 {font-size: 14px;}
  .plot-container.plotly text {
    font-size: 12px !important;
}
</style>

</head>
<body class="body body-- body--sunflower" id="body-">

  <div class="ui-base">
    <a href="#pagecontent" class="skiplink" data-js="skiplink">Skip to main content</a>




<header role="banner" class="header">
	<div class="row">
		<a href="https://devinit.org/" class="branding">Development Initiatives</a>


<button role="button" class="navigation-primary-toggle" id="navigation-primary-toggle"><span>Menu</span></button>

<nav class="navigation-primary" role="navigation" id="navigation-primary">
	<ul class="navigation-primary__items">

			<li class="navigation-primary__item ">
				<a href="https://devinit.org/who-we-are/?nav=header">Who we are</a>
			</li>

			<li class="navigation-primary__item ">
				<a href="https://devinit.org/what-we-do/?nav=header">What we do</a>
			</li>

			<li class="navigation-primary__item ">
				<a href="https://devinit.org/how-we-work/?nav=header">How we work</a>
			</li>

			<li class="navigation-primary__item navigation-primary__item--active">
				<a href="https://devinit.org/resources/?nav=header">Resources</a>
			</li>

			<li class="navigation-primary__item ">
				<a href="https://devinit.org/data/?nav=header">Data</a>
			</li>

			<li class="navigation-primary__item ">
				<a href="https://devinit.org/blog/?nav=header">Blog</a>
			</li>

			<li class="navigation-primary__item ">
				<a href="https://devinit.org/work-for-us/?nav=header">Work for us</a>
			</li>

	</ul>
</nav>

	</div>
</header>


    <!-- ID and -nofocus required for proper skiplink operation -->
    <main id="pagecontent" class="pagecontent -nofocus" role="main" tabindex="-1">




<section class="hero hero--image">

    <div class="hero__image" id="ri9bb2b9"><style scoped="">
            @media all and (min-width: 1px) {
                #ri9bb2b9 {
                    background-image: url(https://devinit.org/media/images/Hero_image_Community_Case_Man.8c3fb3aa.fill-400x300-c100.jpg);
                    background-image: -webkit-image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Man.8c3fb3aa.fill-400x300-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Manageme.8c3fb3aa.fill-800x600.jpg") 2x);
                    background-image: image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Man.8c3fb3aa.fill-400x300-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Manageme.8c3fb3aa.fill-800x600.jpg") 2x);
                    background-position-y: center;
                }
            }


            @media all and (min-width: 400px) {
                #ri9bb2b9 {
                    background-image: url(https://devinit.org/media/images/Hero_image_Community_Case_Man.8c3fb3aa.fill-500x280-c100.jpg);
                    background-image: -webkit-image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Man.8c3fb3aa.fill-500x280-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Managem.8c3fb3aa.fill-1000x560.jpg") 2x);
                    background-image: image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Man.8c3fb3aa.fill-500x280-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Managem.8c3fb3aa.fill-1000x560.jpg") 2x);
                    background-position-y: center;
                }
            }


            @media all and (min-width: 500px) {
                #ri9bb2b9 {
                    background-image: url(https://devinit.org/media/images/Hero_image_Community_Case_Man.8c3fb3aa.fill-780x230-c100.jpg);
                    background-image: -webkit-image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Man.8c3fb3aa.fill-780x230-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Managem.8c3fb3aa.fill-1560x460.jpg") 2x);
                    background-image: image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Man.8c3fb3aa.fill-780x230-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Managem.8c3fb3aa.fill-1560x460.jpg") 2x);
                    background-position-y: center;
                }
            }


            @media all and (min-width: 780px) {
                #ri9bb2b9 {
                    background-image: url(https://devinit.org/media/images/Hero_image_Community_Case_Ma.8c3fb3aa.fill-1000x435-c100.jpg);
                    background-image: -webkit-image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Ma.8c3fb3aa.fill-1000x435-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Managem.8c3fb3aa.fill-2000x870.jpg") 2x);
                    background-image: image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Ma.8c3fb3aa.fill-1000x435-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Managem.8c3fb3aa.fill-2000x870.jpg") 2x);
                    background-position-y: center;
                }
            }


            @media all and (min-width: 1000px) {
                #ri9bb2b9 {
                    background-image: url(https://devinit.org/media/images/Hero_image_Community_Case_Ma.8c3fb3aa.fill-1350x435-c100.jpg);
                    background-image: -webkit-image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Ma.8c3fb3aa.fill-1350x435-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Managem.8c3fb3aa.fill-2700x870.jpg") 2x);
                    background-image: image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Ma.8c3fb3aa.fill-1350x435-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Managem.8c3fb3aa.fill-2700x870.jpg") 2x);
                    background-position-y: center;
                }
            }


            @media all and (min-width: 1350px) {
                #ri9bb2b9 {
                    background-image: url(https://devinit.org/media/images/Hero_image_Community_Case_Ma.8c3fb3aa.fill-1800x430-c100.jpg);
                    background-image: -webkit-image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Ma.8c3fb3aa.fill-1800x430-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Managem.8c3fb3aa.fill-3600x860.jpg") 2x);
                    background-image: image-set(url("https://devinit.org/media/images/Hero_image_Community_Case_Ma.8c3fb3aa.fill-1800x430-c100.jpg") 1x, url("https://devinit.org/media/images/Hero_image_Community_Case_Managem.8c3fb3aa.fill-3600x860.jpg") 2x);
                    background-position-y: center;
                }
            }

        </style></div>

      <span class="hero__credit">Image by

          <a href="http://www.flickr.com/photos/savethechildrenusa/5634621403/" target="_blank">Save the Children</a>

      </span>



  <span class="hero__flourish"></span>
  <span class="hero__flourish"></span>
  <span class="hero__flourish"></span>
  <span class="hero__flourish"></span>
  <span class="hero__flourish"></span>
  <span class="hero__flourish"></span>
  <span class="hero__flourish"></span>
  <span class="hero__flourish"></span>
  <div class="row row--narrow">
    <div class="hero__content">
      <ul class="hero__meta">

          <li class="hero__meta-item hero__meta-item--block">Factsheet</li>


          <li class="hero__meta-item">18 September 2020</li>

      </ul>


      <h1 class="hero__title">
        <span>Covid-19 effects on the poorest 20% of people worldwide</span>
      </h1>

    </div>
  </div>
</section>



    <section class="section section--large">
      <div class="row row--narrow">


            <div class="max-meter max-meter--center">


<div class="m-authors">
    <h3 class="m-authors__title">

        Authors

    </h3>
    <p class="m-authors__copy">




            <a href="https://devinit.org/who-we-are/our-team/zach-christensen/?referrer=author">
              Zach Christensen
            </a>




    </p>
</div>


            </div>








<div class="section-chapter" id="section-1-1">
    <div class="max-meter max-meter--center">
        <!-- <span class="section-chapter__number">1.1</span> -->
        <a href="#section-1-1" data-id="section-1-1" data-js="share-section-trigger" class="section-chapter__link"><i role="presentation" aria-hidden="true" class="ico ico--16 ico-link-sunflower"></i>
Share section</a>


<div class="share__wrapper" data-js="share-section" data-id="section-1-1" aria-hidden="true">

        <ul class="share__media">
            <li class="share__item">
                <a class="js-social-share" data-event-label="Share section with Facebook / Introduction / https://devinit.org/2b4b7e#section-1-1" data-event-category="Share" href="https://www.facebook.com/sharer/sharer.php?u=https%3A//devinit.org/2b4b7e%23section-1-1" target="_blank"><img src="https://devinit.org/assets/svg/source/facebook.9d990725fab2.svg" alt="Share with Facebook"></a>
            </li>
            <li class="share__item">
                <a class="js-social-share" data-event-label="Share section  with Twitter / Introduction / https://devinit.org/2b4b7e#section-1-1" data-event-category="Share" href="https://twitter.com/intent/tweet/?text=Introduction&amp;url=https%3A//devinit.org/2b4b7e%23section-1-1" target="_blank"><img src="https://devinit.org/assets/svg/source/twitter.a5f3564d3e87.svg" alt="Share with Twitter"></a>
            </li>
            <li class="share__item">
                <a class="js-social-share" data-event-label="Share section  with LinkedIn / Introduction / https://devinit.org/2b4b7e#section-1-1" data-event-category="Share" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A//devinit.org/2b4b7e%23section-1-1&amp;title=Introduction" target="_blank"><img src="https://devinit.org/assets/svg/source/linkedin.185123306969.svg" alt="Share with LinkedIn"></a>
            </li>
        </ul>

    <div class="share__copy ">
        <input readonly="" class="js-copy-field" type="text" value="https://devinit.org/2b4b7e#section-1-1" title="Short URL for sharing">
        <button class="button js-copy-trigger">Copy</button>
    </div>
</div>

        <h2 class="section-chapter__heading">Introduction</h2>
    </div>
</div>


      </div>
    </section>

    <section class="section section--large">
      <div class="row row--narrow">
        <div class="max-meter max-meter--center">
          <div class="is-typeset wysiwyg ">
            <p>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin massa eros, pellentesque et auctor ac, porta et libero. Maecenas tristique sapien in orci venenatis molestie. Etiam ullamcorper elit diam, vitae laoreet nisi laoreet nec. Ut consequat rutrum congue. Nulla eget condimentum turpis. Pellentesque aliquet suscipit mauris vel rutrum. Nullam ut venenatis metus. Etiam ut fringilla leo. Nulla in libero justo. Etiam mollis commodo sem, a efficitur eros blandit gravida. Ut quis fringilla mauris. In lobortis aliquam mauris at mollis. Maecenas lectus purus, rhoncus non erat id, malesuada tincidunt leo. Proin feugiat, magna eget feugiat maximus, nisi eros feugiat sem, eu scelerisque velit risus sit amet purus. Vivamus est urna, scelerisque non rhoncus quis, dapibus vel massa.
            </p>
          </div>
        </div>
      </div>
    </section>
    <section class="section section--large">
      <div class="row row--narrow">
        <div class="max-meter max-meter--center responsive-graph">
          <h3 class="type-l type-l--trailer">Figure 1: How has Covid-19 affected the percentage of people in poverty?</h3>
            <div class="chart-container chart-container--full js-plotly-chart-wrapper">
              <select class="data-selector js-plotly-chart-data-selector data-selector--active" id="countrySelectCovid1" style="position:relative;float:left;"></select>
              <select class="data-selector js-plotly-chart-data-selector data-selector--active" id="indicatorSelectCovid1" style="position:relative;float:left;"></select>
              <div class="charts__chart js-plotly-chart js-plotly-plot" style="min-height:0px; padding-top: 8%;">
                <div class="plot-container plotly">
                  <div class="svg-container" style="position: relative; width: 100%;" id="covid-chart1"></div>
                </div>
              </div>
            </div>
          <div class="chart-fallback">
            <a href="https://devinit.org/media/images/20_contributors_of_the_largest_amounts_of_int.width-1400.png" target="_blank" title="Click to open image in a new window">
                <span class="chart-fallback__no-js-small-screen-image" style="background-image: url('https://devinit.org//media/images/20_contributors_of_the_largest_amounts_of_int.width-1000.png'); padding-top: 43.8%;"></span>
            </a>
          </div>
          <div class="chart-fallback__alert">
            <p>To view this interactive visualisation make sure JavaScript is available on your device.</p>
          </div>
          <div class="chart-fallback__alert chart-fallback__alert--ss">
            <p>To view this interactive visualisation use a device with a larger screen.</p>
          </div>
          <figcaption class="media-caption">
            <p>Source: Development Initiatives based on the World Bank's PovCalNet and the International Monetary Fund's World Economic Indicators.</p>
            <p>Notes: We define extreme poverty as measured using the 2011 PPP$1.90 extreme poverty line. Purchasing power parity (PPP) prices are the rate at which a country's currency would have to be converted into that of another country to buy the same amount of goods and services in each country. PPPs are constructed by comparing the cost of a common basket of goods in different countries. Where subsequent figures in the report are in PPP these are denominated as $.</p>
          </figcaption>
        </div>
      </div>
    </section>
    <section class="section section--large">
      <div class="row row--narrow">
        <div class="max-meter max-meter--center">
          <div class="is-typeset wysiwyg ">
            <p>
              Mauris finibus, purus nec finibus finibus, ligula odio mollis lectus, eu condimentum ante libero ut mi. Nullam interdum felis eget sem accumsan, quis interdum lectus interdum. Nullam mattis molestie pulvinar. Integer ut ligula fringilla, egestas purus eu, condimentum mauris. Donec fermentum mi ac tortor sagittis, eget finibus massa ullamcorper. Cras vel elit et metus vestibulum tempus et sit amet metus. Interdum et malesuada fames ac ante ipsum primis in faucibus. Donec eu nisl ac lacus sollicitudin hendrerit quis id dui. Integer vehicula tortor ut lorem laoreet scelerisque. Sed eget mattis ex, vel sollicitudin justo. Phasellus nec finibus arcu, at tempor erat. Vestibulum sodales, turpis in pretium elementum, sapien elit sodales est, nec faucibus eros felis quis massa.
            </p>
            <p>
              Aenean non ipsum at quam dictum laoreet vel ac purus. In in orci porttitor, varius purus non, volutpat nunc. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin eu nisl vel magna dignissim luctus. Donec feugiat vulputate interdum. Sed ullamcorper vitae libero eget tincidunt. Suspendisse at ligula nec odio condimentum auctor quis id lectus. Cras scelerisque dui posuere fermentum elementum. Pellentesque arcu est, rutrum ut mauris vel, mollis finibus arcu. Morbi quis aliquam erat. Pellentesque mollis non quam nec ullamcorper. Vivamus arcu dolor, ullamcorper in scelerisque eu, consectetur eget sapien. Praesent in leo et velit efficitur facilisis nec quis neque. In mollis sem eget suscipit eleifend. Curabitur vestibulum quam ut enim sollicitudin consectetur.
            </p>
          </div>
        </div>
      </div>
    </section>
    <section class="section section--large">
      <div class="row row--narrow">
        <div class="max-meter max-meter--center responsive-graph">
          <h3 class="type-l type-l--trailer">Figure 2: How has Covid-19 affected the gap between the richest and the poorest?</h3>
            <div class="chart-container chart-container--full js-plotly-chart-wrapper">
              <select class="data-selector js-plotly-chart-data-selector data-selector--active" id="countrySelectCovid2" style="position:relative;float:left;"></select>
              <select class="data-selector js-plotly-chart-data-selector data-selector--active" id="indicatorSelectCovid2" style="position:relative;float:left;">
                <option value="percent">Percentage change</option>
                <option value="nominal">Absolute income gap</option>
              </select>
              <div class="charts__chart js-plotly-chart js-plotly-plot" style="min-height:0px; padding-top: 8%;">
                <div class="plot-container plotly">
                  <div class="svg-container" style="position: relative; width: 100%;" id="covid-chart2"></div>
                </div>
              </div>
            </div>
          <div class="chart-fallback">
            <a href="https://devinit.org/media/images/20_contributors_of_the_largest_amounts_of_int.width-1400.png" target="_blank" title="Click to open image in a new window">
                <span class="chart-fallback__no-js-small-screen-image" style="background-image: url('https://devinit.org//media/images/20_contributors_of_the_largest_amounts_of_int.width-1000.png'); padding-top: 43.8%;"></span>
            </a>
          </div>
          <div class="chart-fallback__alert">
            <p>To view this interactive visualisation make sure JavaScript is available on your device.</p>
          </div>
          <div class="chart-fallback__alert chart-fallback__alert--ss">
            <p>To view this interactive visualisation use a device with a larger screen.</p>
          </div>
          <figcaption class="media-caption">
            <p>Source: Development Initiatives based on World Bank and DHS/MICS surveys.</p>
          </figcaption>
        </div>
      </div>
    </section>
    <section class="section section--large">
      <div class="row row--narrow">
        <div class="max-meter max-meter--center">
          <div class="is-typeset wysiwyg ">
            <p>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin massa eros, pellentesque et auctor ac, porta et libero. Maecenas tristique sapien in orci venenatis molestie. Etiam ullamcorper elit diam, vitae laoreet nisi laoreet nec. Ut consequat rutrum congue. Nulla eget condimentum turpis. Pellentesque aliquet suscipit mauris vel rutrum. Nullam ut venenatis metus. Etiam ut fringilla leo. Nulla in libero justo. Etiam mollis commodo sem, a efficitur eros blandit gravida. Ut quis fringilla mauris. In lobortis aliquam mauris at mollis. Maecenas lectus purus, rhoncus non erat id, malesuada tincidunt leo. Proin feugiat, magna eget feugiat maximus, nisi eros feugiat sem, eu scelerisque velit risus sit amet purus. Vivamus est urna, scelerisque non rhoncus quis, dapibus vel massa.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section class="section section--large">
      <div class="row row--narrow">
        <div class="max-meter max-meter--center responsive-graph">
          <h3 class="type-l type-l--trailer">Figure 3: Why are people in poverty more vulnerable to pandemics?</h3>
            <div class="chart-container chart-container--full js-plotly-chart-wrapper">
              <select class="data-selector js-plotly-chart-data-selector data-selector--active" id="countrySelectCovid3" style="position:relative;float:left;"></select>
              <select class="data-selector js-plotly-chart-data-selector data-selector--active" id="indicatorSelectCovid3" style="position:relative;float:left;"></select>
              <select class="data-selector js-plotly-chart-data-selector data-selector--active" id="demographicSelectCovid3" style="position:relative;float:left;"></select>
              <div class="charts__chart js-plotly-chart js-plotly-plot" style="min-height:0px; padding-top: 8%;">
                <div class="plot-container plotly">
                  <div class="svg-container" style="position: relative; width: 100%;" id="covid-chart3"></div>
                </div>
              </div>
            </div>
          <div class="chart-fallback">
            <a href="https://devinit.org/media/images/20_contributors_of_the_largest_amounts_of_int.width-1400.png" target="_blank" title="Click to open image in a new window">
                <span class="chart-fallback__no-js-small-screen-image" style="background-image: url('https://devinit.org//media/images/20_contributors_of_the_largest_amounts_of_int.width-1000.png'); padding-top: 43.8%;"></span>
            </a>
          </div>
          <div class="chart-fallback__alert">
            <p>To view this interactive visualisation make sure JavaScript is available on your device.</p>
          </div>
          <div class="chart-fallback__alert chart-fallback__alert--ss">
            <p>To view this interactive visualisation use a device with a larger screen.</p>
          </div>
          <figcaption class="media-caption">
            <p>Source: Development Initiatives based on World Bank and DHS/MICS surveys.</p>
          </figcaption>
        </div>
      </div>
    </section>
    <script>
    // Start chart 1
    var currentSelection1 = [];
    var currentIndicator1 = "Extreme poverty";
    var current_data1 = [];

    // set the dimensions and margins of the graph
    var margin1 = {top: 10, right: 330, bottom: 50, left: 80},
        width1 = 800 - margin1.left - margin1.right,
        height1 = 300 - margin1.top - margin1.bottom;

    // append the svg object to the body of the page
    var svg1 = d3.select("#covid-chart1")
      .append("svg")
        .attr('preserveAspectRatio', 'xMinYMin meet')
        .attr("viewBox", "0 0 " + (width1 + margin1.left + margin1.right) + " " + (height1 + margin1.top + margin1.bottom))
        .attr("style","background-color: white;")
      .append("g")
        .attr("transform",
              "translate(" + margin1.left + "," + margin1.top + ")");


    //Read the data
    d3.csv("../covid-projections/covid_proj.csv", function(original_data) {

        var allCountries = d3.map(original_data, function(d){return(d.name)}).keys();
        var allIndicator = d3.map(original_data, function(d){return(d.povtype)}).keys();
        var allPPP = d3.map(original_data, function(d){return(d.ppp)}).keys();

        data = original_data.filter(function(d){return d.povtype == currentIndicator1});

        // add the options to the button
        d3.select("#countrySelectCovid1")
          .selectAll('myOptions')
         	.data(allCountries)
          .enter()
        	.append('option')
          .text(function (d) { return d; }) // text showed in the menu
          .attr("value", function (d) { return d; }) // corresponding value returned by the buttons

        d3.select("#indicatorSelectCovid1")
          .selectAll('myOptions')
         	.data(allIndicator)
          .enter()
        	.append('option')
          .text(function (d) { return d; }) // text showed in the menu
          .attr("value", function (d) { return d; }) // corresponding value returned by the buttons

        // A color scale: one color for each group
        var myColor = d3.scaleOrdinal()
          .range(["#e84439", "#109e68", "#893f90"]);

        // Add X axis
        var x = d3.scaleLinear()
          .domain(d3.extent(data, function(d) { return d.year; }))
          .range([ 0, width1 ]);
        var xAxis = d3.axisBottom(x).ticks(7).tickSizeOuter(0).tickFormat(d3.format("d"));
        svg1.append("g").attr("class","myXaxis1")
          .attr("transform", "translate(0," + height1 + ")")
          .call(xAxis);
        // Add X axis label:
        svg1.append("text")
            .attr("class","axis-title")
            .attr("text-anchor", "middle")
            .attr("x", width1 / 2)
            .attr("y", height1 + margin1.top + 25)
            .text("Year");

        var formatPercent = d3.format(".0%");
        var formatPercentAccurate = d3.format(".2%");

        // Add Y axis
        var y = d3.scaleLinear()
          .domain([0, d3.max(data.filter(function(d){return d.name=="World"}), function(d) { return +d.value; })])
          .range([ height1, 0 ])
          .nice();
        var yAxis = d3.axisLeft().scale(y).ticks(7).tickSizeOuter(0).tickFormat(formatPercent);
        svg1.append("g").attr("class","myYaxis1")
          .call(yAxis);
        // add the Y gridlines
        var yGrid = d3.axisLeft().scale(y).ticks(7).tickSizeOuter(0).tickSize(-width1).tickFormat("");
        svg1.append("g")
            .attr("class", "yGrid1")
            .call(yGrid);
        // Y axis label:
        svg1.append("text")
            .attr("class","axis-title")
            .attr("id", "y-axis-title1")
            .attr("text-anchor", "end")
            .attr("transform", "rotate(-90)")
            .attr("y", -margin1.left+20)
            .attr("x", 0)
            .text("Percentage of population living in poverty")

        var pre_line = svg1
          .append('g')
          .attr("class", "pre-line1");
        var post_line = svg1
          .append('g')
          .attr("class", "post-line1");

        // A function that update the chart
        function update(selectedCountry, selectedIndicator, selectedPPP) {

          if(selectedIndicator !== null){
            currentIndicator1 = selectedIndicator;
          };

          data = original_data.filter(function(d){return d.povtype == currentIndicator1});

          if(!currentSelection1.includes(selectedCountry) && selectedCountry !== null){
            currentSelection1.push(selectedCountry);
          };

          if(currentSelection1.length > 3){
            currentSelection1.shift()
          }

          // Update color axis
          myColor.domain(currentSelection1)

          // Create new data with the selection
          var dataFilter = data.filter(function(d){return currentSelection1.includes(d.name)})
          current_data1 = dataFilter;
          var dataFilter_pre = data.filter(function(d){return currentSelection1.includes(d.name) && d.covid=="FALSE"})
          var dataFilter_post = data.filter(function(d){return currentSelection1.includes(d.name) && d.covid=="TRUE"})

          svg1.selectAll('path.country_line1').remove();
          svg1.selectAll('g.legend_item_icon1').remove();
          svg1.selectAll('g.legend_item_text1').remove();
          svg1.selectAll('circle.highlight1').attr("style","opacity:0;");
          legend
            .selectAll('g.legend_item_icon1')
            .data(currentSelection1)
            .enter()
            .append("g")
            .attr("class", "legend_item_icon1")
            .on("click", function(d) {
              if(currentSelection1.length > 1){
                var selectedIndex = currentSelection1.indexOf(d);
                if(selectedIndex > -1){
                  currentSelection1.splice(selectedIndex, 1);
                };
                update(null, null, null);
              };

            })
            .append("rect")
            .attr("x", width1)
            .attr("y", function(d,i){ return 90 + i*15 - (10/2) })
            .attr("width", 10)
            .attr("height", 10)
            .style("fill", function(d){ return myColor(d)})
            .style("cursor", "pointer");
          legend
            .selectAll('g.legend_item_text1')
            .data(currentSelection1)
            .enter()
            .append("g")
            .attr("class", "legend_item_text1")
            .on("click", function(d) {
              if(currentSelection1.length > 1){
                var selectedIndex = currentSelection1.indexOf(d);
                if(selectedIndex > -1){
                  currentSelection1.splice(selectedIndex, 1);
                };
                update(null, null, null);
              };

            })
            .append("text")
            .attr("x", width1 + 25)
            .attr("y", function(d,i){ return 90 + i*15 + 4})
            .style("fill", function(d){ return myColor(d)})
            .style("cursor", "pointer")
            .text(function(d){ return d })
            .attr("text-anchor", "left")
            .style("font-size", "10px");


          for(var i = 0; i < currentSelection1.length; i++){
            selected_country = currentSelection1[i];
            pre_line
              .append("path")
              .attr("class", "country_line1")
                .datum(data.filter(function(d){return d.name==selected_country && d.covid=="FALSE"}))
                .attr("d", d3.line()
                  .x(function(d) { return x(d.year) })
                  .y(function(d) { return y(+d.value) })
                )
                .attr("stroke", function(d){ return myColor(selected_country) })
                .style("stroke-width", 2)
                .style("fill", "none")
                .style("stroke-dasharray", "3, 3");
            pre_line
            .append("path")
            .attr("class", "country_line1")
              .datum(data.filter(function(d){return d.name==selected_country && d.covid=="FALSE" && d.estimate=="FALSE"}))
              .attr("d", d3.line()
                .x(function(d) { return x(d.year) })
                .y(function(d) { return y(+d.value) })
              )
              .attr("stroke", function(d){ return myColor(selected_country) })
              .style("stroke-width", 2)
              .style("fill", "none");

            post_line
              .append("path")
              .attr("class", "country_line1")
                .datum(data.filter(function(d){return d.name==selected_country && d.covid=="TRUE"}))
                .attr("d", d3.line()
                  .x(function(d) { return x(d.year) })
                  .y(function(d) { return y(+d.value) })
                )
                .attr("stroke", function(d){ return d3.rgb(myColor(selected_country)).darker() })
                .style("stroke-width", 2)
                .style("fill", "none")
                .style("stroke-dasharray", "5, 5");
            post_line
              .append("path")
              .attr("class", "country_line1")
                .datum(data.filter(function(d){return d.name==selected_country && d.covid=="TRUE" && d.estimate=="FALSE"}))
                .attr("d", d3.line()
                  .x(function(d) { return x(d.year) })
                  .y(function(d) { return y(+d.value) })
                )
                .attr("stroke", function(d){ return d3.rgb(myColor(selected_country)).darker() })
                .style("stroke-width", 2)
                .style("fill", "none");
          };

          // Adjust X axis
          x.domain(d3.extent(data, function(d) { return d.year; }));
          svg1.selectAll(".myXaxis1")
          .transition()
          .duration(1000)
          .call(xAxis);
          // Adjust y axis
          var ymax = d3.max(data.filter(function(d){return currentSelection1.includes(d.name)}), function(d) { return +d.value; });
          if(ymax < 0.01){
            formatPercent = d3.format(".2%");
          }else if(ymax < 0.05){
            formatPercent = d3.format(".1%");
          }else{
            formatPercent = d3.format(".0%");
          };
          yAxis.tickFormat(formatPercent);
          y.domain([0, d3.max(data.filter(function(d){return currentSelection1.includes(d.name)}), function(d) { return +d.value; })]).nice();
          svg1.selectAll(".myYaxis1")
          .transition()
          .duration(1000)
          .call(yAxis);
          svg1.selectAll(".yGrid1")
          .transition()
          .duration(1000)
          .call(yGrid);

          svg1.selectAll('path.country_line1')
          .transition()
          .duration(1000)
          .attr("d", d3.line()
            .x(function(d) { return x(d.year) })
            .y(function(d) { return y(+d.value) })
          )
        }

        // When the button is changed, run the updateChart function
        d3.select("#countrySelectCovid1").on("change", function(d) {
            // recover the option that has been chosen
            var selectedOption = d3.select(this).property("value");
            // run the updateChart function with this selected option
            update(selectedOption, null, null);
        });
        d3.select("#indicatorSelectCovid1").on("change", function(d) {
            // recover the option that has been chosen
            var selectedOption = d3.select(this).property("value");
            // run the updateChart function with this selected option
            update(null, selectedOption, null);
        });



        var legend = svg1
          .append("g")
          .attr("transform","translate(30, 0)");

        legend
          .append("rect")
          .attr("x", width1 - 10)
          .attr("y", 0)
          .attr("width", margin1.right - 40)
          .attr("height", height1)
          .attr("fill", "#f8f7f8")

        var static_legend_items = [
          {"name": "Measured poverty %", "color": d3.rgb("#a9a6aa"), "dasharray": "0"},
          {"name": "Before Covid-19: Estimated poverty %", "color": d3.rgb("#a9a6aa"), "dasharray": "3, 3"},
          {"name": "After Covid-19: Estimated poverty %", "color": d3.rgb("#a9a6aa").darker(), "dasharray": "5, 5"},
        ]

        legend
          .selectAll('g.static_legend_lines1')
          .data(static_legend_items)
          .enter()
          .append("g")
          .attr("class", "static_legend_lines1")
          .append("path")
          .attr("d", function(d, i){return "m " + width1 + " " + (20 + i*15) + " H " + (width1 + 20) })
          .attr("stroke", function(d){ return d.color })
          .style("stroke-width", 2)
          .style("fill", "none")
          .style("stroke-dasharray", function(d){ return d.dasharray });

        legend
          .selectAll('g.static_legend_text1')
          .data(static_legend_items)
          .enter()
          .append("g")
          .attr("class", "static_legend_text1")
          .append("text")
          .attr("x", width1 + 25)
          .attr("y", function(d,i){ return 20 + i*15 + 4})
          .style("fill", function(d){ return d.color})
          .text(function(d){ return d.name })
          .attr("text-anchor", "left")
          .style("font-size", "10px");

        legend
          .append("text")
          .attr("x", width1)
          .attr("y", 75)
          .style("fill", "#443e42")
          .style("font-size", "10px")
          .text("Selected regions/countries (click to remove)")

        update("World", "Extreme poverty", "2011");

        var tooltip1 = d3.select("#covid-chart1").append("div")
          .attr("class", "tooltip1")
          .attr("style", "position: absolute; display: none;")

        var highlight1 = svg1
          .append("circle")
          .attr("class", "highlight1")
          .attr("r", 2.5)
          .attr("style","opacity:0;");

        svg1.append("rect")
          .attr("class", "overlay1")
          .attr("style","opacity:0;")
          .attr("width", width1)
          .attr("height", height1)
          .on("mousemove", function(){
            var mouse_position = d3.mouse(this);
            var x_pos = x.invert(mouse_position[0]);
            var y_pos = y.invert(mouse_position[1]);
            var matrix = this.getScreenCTM();
            var closest_year_distance = d3.min(current_data1, function(d){ return Math.abs(x_pos - d.year)});
            var closest_year = current_data1.filter(function(d){return Math.abs(x_pos - d.year) == closest_year_distance})[0].year;
            var current_data_by_year = current_data1.filter(function(d){ return d.year == closest_year });
            var closest_value_distance = d3.min(current_data_by_year, function(d){ return Math.abs(y_pos - d.value)});
            var closest_value = current_data_by_year.filter(function(d){return Math.abs(y_pos - d.value) == closest_value_distance})[0].value;
            var highlight_data = current_data_by_year.filter(function(d){ return d.value == closest_value});
            tooltip1
              .attr("style",
              "position: absolute;display: block;background-color:rgba(255,255,255,0.8);" +
              "top:" + (d3.event.clientY - matrix.f + margin1.top + height1*0.08) + "px;" +
              "left:" + (d3.event.clientX - matrix.e + margin1.left) + "px;"
            ).html(
              "<p><b>Name:</b> " + highlight_data[0].name + "</p>" +
              "<p><b>Year:</b> " + highlight_data[0].year + "</p>" +
              (highlight_data[0].estimate == "TRUE" ? ("<p><b>Estimate:</b> " + (highlight_data[0].covid == "TRUE" ? "After Covid-19": "Before Covid-19") + "</p>") : "") +
              "<p><b>Value:</b> " + formatPercentAccurate(highlight_data[0].value) + "</p>"
            )
            highlight1
              .data(highlight_data)
              .attr("cx", function(d){return x(d.year)})
              .attr("cy", function(d){return y(d.value)})
              .attr("fill", function(d){return d.covid == "TRUE" ? d3.rgb(myColor(d.name)).darker() : myColor(d.name) })
              .attr("style","opacity:1;");
          })
          .on('mouseout', function(){
            tooltip1
              .attr("style", "position: absolute; display: none;")
            highlight1
              .attr("style","opacity:0;");
          });

    })

    // end chart 1
    // start chart 2

    var selected_indicator2 = "percent";
    var current_data2 = [];

    // set the dimensions and margins of the graph
    var margin2 = {top: 10, right: 320, bottom: 50, left: 80},
        width2 = 800 - margin2.left - margin2.right,
        height2 = 300 - margin2.top - margin2.bottom;

    // append the svg object to the body of the page
    var svg2 = d3.select("#covid-chart2")
      .append("svg")
        .attr('preserveAspectRatio', 'xMinYMin meet')
        .attr("viewBox", "0 0 " + (width2 + margin2.left + margin2.right) + " " + (height2 + margin2.top + margin2.bottom))
        .attr("style","background-color: white;")
      .append("g")
        .attr("transform",
              "translate(" + margin2.left + "," + margin2.top + ")");


    //Read the data
    d3.csv("../covid-proj-np20/covid_proj2.csv", function(data) {

        var allCountries = d3.map(data, function(d){return(d.name)}).keys();
        var allPovs = d3.map(data, function(d){return(d.povtype)}).keys();

        // add the options to the button
        d3.select("#countrySelectCovid2")
          .selectAll('myOptions')
         	.data(allCountries)
          .enter()
        	.append('option')
          .text(function (d) { return d; }) // text showed in the menu
          .attr("value", function (d) { return d; }) // corresponding value returned by the buttons

        // A color scale: one color for each group
        var myColor = d3.scaleOrdinal()
          .domain(["Poorest 20%", "Rest of population"])
          .range(["#0089cc", "#f49b21"]);

        // Add X axis
        var x = d3.scaleLinear()
          .domain(d3.extent(data, function(d) { return d.year; }))
          .range([ 0, width2 ]);
        var xAxis = d3.axisBottom(x).ticks(7).tickSizeOuter(0).tickFormat(d3.format("d"));
        svg2.append("g").attr("class","myXaxis2")
          .attr("transform", "translate(0," + height2 + ")")
          .call(xAxis);
        // Add X axis label:
        svg2.append("text")
            .attr("class","axis-title")
            .attr("text-anchor", "middle")
            .attr("x", width2 / 2)
            .attr("y", height2 + margin2.top + 25)
            .text("Year");

        var valueFormat = d3.format("$,.0f");
        var valueFormatAccurate = d3.format("$,.2f");

        // Add Y axis
        var y = d3.scaleLinear()
          .domain([0, d3.max(data.filter(function(d){return d.name=="Albania"}), function(d) { return +d.value; })])
          .range([ height2, 0 ])
          .nice();
        var yAxis = d3.axisLeft().scale(y).ticks(7).tickSizeOuter(0).tickFormat(valueFormat);
        svg2.append("g").attr("class","myYaxis2")
          .call(yAxis);
        // add the Y gridlines
        var yGrid = d3.axisLeft().scale(y).ticks(7).tickSizeOuter(0).tickSize(-width2).tickFormat("");
        svg2.append("g")
            .attr("class", "yGrid2")
            .call(yGrid);
        // Y axis label:
        svg2.append("text")
            .attr("class","axis-title")
            .attr("id", "y-axis-title2")
            .attr("text-anchor", "end")
            .attr("transform", "rotate(-90)")
            .attr("y", -margin2.left+20)
            .attr("x", 0)
            .text("Daily per capita income (2011 PPP$)")

        var pre_line = svg2
          .append('g')
          .attr("class", "pre-p20-line2");
        var post_line = svg2
          .append('g')
          .attr("class", "post-p20-line2");

        // A function that update the chart
        function update(selectedCountry, selectedIndicator) {

          svg2.selectAll('path.country_line2').remove();
          svg2.selectAll('g.legend_item_icon2').remove();
          svg2.selectAll('g.legend_item_text2').remove();
          svg2.selectAll('circle.highlight2').attr("style","opacity:0;");
          var country_dat = data.map(function(obj) {
              return Object.assign({}, obj);
          });
          country_dat = country_dat.filter(function(d){return d.name==selectedCountry});
          current_data2 = country_dat;

          for(var i = 0; i < allPovs.length; i++){
            selected_pov = allPovs[i];
            var poverty_dat = country_dat.filter(function(d){return d.povtype==selected_pov});
            if(selectedIndicator == "percent"){
              var year_min = d3.min(poverty_dat,function(d){return d.year});
              var baseline = poverty_dat.filter(function(d){return d.year==year_min})[0].value;
              poverty_dat.forEach(function(d,i,dat){dat[i].value = d.value/baseline; });
            };
            pre_line
              .append("path")
              .attr("class", "country_line2")
                .datum(poverty_dat.filter(function(d){return d.covid=="FALSE"}))
                .attr("d", d3.line()
                  .x(function(d) { return x(d.year) })
                  .y(function(d) { return y(+d.value) })
                )
                .attr("stroke", function(d){ return myColor(selected_pov) })
                .style("stroke-width", 2)
                .style("fill", "none")
                .style("stroke-dasharray", "3, 3");
            pre_line
            .append("path")
            .attr("class", "country_line2")
              .datum(poverty_dat.filter(function(d){return d.covid=="FALSE" && d.estimate=="FALSE"}))
              .attr("d", d3.line()
                .x(function(d) { return x(d.year) })
                .y(function(d) { return y(+d.value) })
              )
              .attr("stroke", function(d){ return myColor(selected_pov) })
              .style("stroke-width", 2)
              .style("fill", "none");

            post_line
              .append("path")
              .attr("class", "country_line2")
                .datum(poverty_dat.filter(function(d){return d.covid=="TRUE"}))
                .attr("d", d3.line()
                  .x(function(d) { return x(d.year) })
                  .y(function(d) { return y(+d.value) })
                )
                .attr("stroke", function(d){ return d3.rgb(myColor(selected_pov)).darker() })
                .style("stroke-width", 2)
                .style("fill", "none")
                .style("stroke-dasharray", "5, 5");
            post_line
              .append("path")
              .attr("class", "country_line2")
                .datum(poverty_dat.filter(function(d){return d.covid=="TRUE" && d.estimate=="FALSE"}))
                .attr("d", d3.line()
                  .x(function(d) { return x(d.year) })
                  .y(function(d) { return y(+d.value) })
                )
                .attr("stroke", function(d){ return d3.rgb(myColor(selected_pov)).darker() })
                .style("stroke-width", 2)
                .style("fill", "none");
          };

          // Adjust X axis
          x.domain(d3.extent(country_dat, function(d) { return d.year; }));
          svg2.selectAll(".myXaxis2")
          .transition()
          .duration(1000)
          .call(xAxis);
          // Adjust y axis
          if(selectedIndicator == "percent"){
            d3.select("#y-axis-title2").text("Change in daily per capita income (%)")
            var ymax = d3.max(country_dat, function(d) { return +d.value; });
            if(ymax < 0.01){
              valueFormat = d3.format(".2%");
            }else if(ymax < 0.05){
              valueFormat = d3.format(".1%");
            }else{
              valueFormat = d3.format(".0%");
            };
            valueFormatAccurate = d3.format(".2%");
          }else{
            d3.select("#y-axis-title2").text("Daily per capita income (2011 PPP$)")
            var ymax = d3.max(country_dat, function(d) { return +d.value; });
            if(ymax < 5){
              valueFormat = d3.format("$,.2f");
            }else{
              valueFormat = d3.format("$,.0f");
            };
            valueFormatAccurate = d3.format("$,.2f");
          }
          yAxis.tickFormat(valueFormat);
          y.domain([0, d3.max(country_dat, function(d) { return +d.value; })]).nice();
          svg2.selectAll(".myYaxis2")
          .transition()
          .duration(1000)
          .call(yAxis);
          svg2.selectAll(".yGrid2")
          .transition()
          .duration(1000)
          .call(yGrid);

          svg2.selectAll('path.country_line2')
          .transition()
          .duration(1000)
          .attr("d", d3.line()
            .x(function(d) { return x(d.year) })
            .y(function(d) { return y(+d.value) })
          )
        }

        // When the button is changed, run the updateChart function
        d3.select("#countrySelectCovid2").on("change", function(d) {
            // recover the option that has been chosen
            var selectedOption = d3.select(this).property("value");
            // run the updateChart function with this selected option
            update(selectedOption, selected_indicator2);
        });
        d3.select("#indicatorSelectCovid2").on("change", function(d) {
            // recover the option that has been chosen
            var selectedOption = d3.select("#countrySelectCovid2").property("value");
            selected_indicator2 = d3.select(this).property("value");
            // run the updateChart function with this selected option
            update(selectedOption, selected_indicator2);
        });

        var legend = svg2
          .append("g")
          .attr("transform","translate(30, 0)");

        legend
          .append("rect")
          .attr("x", width2 - 10)
          .attr("y", 0)
          .attr("width", margin2.right - 40)
          .attr("height", height2)
          .attr("fill", "#f8f7f8")

        var static_legend_items = [
          {"name": "Rest of population measured", "color": myColor("Rest of population"), "dasharray": "0"},
          {"name": "Rest of population estimate before Covid-19", "color": myColor("Rest of population"), "dasharray": "3, 3"},
          {"name": "Rest of population estimate after Covid-19", "color": d3.rgb(myColor("Rest of population")).darker().darker(), "dasharray": "5, 5"},
          {"name": "Poorest 20% measured", "color": myColor("Poorest 20%"), "dasharray": "0"},
          {"name": "Poorest 20% estimate before Covid-19", "color": myColor("Poorest 20%"), "dasharray": "3, 3"},
          {"name": "Poorest 20% estimate after Covid-19", "color": d3.rgb(myColor("Poorest 20%")).darker().darker(), "dasharray": "5, 5"},
        ]

        legend
          .selectAll('g.static_legend_lines2')
          .data(static_legend_items)
          .enter()
          .append("g")
          .attr("class", "static_legend_lines2")
          .append("path")
          .attr("d", function(d, i){return "m " + width2 + " " + (20 + i*15) + " H " + (width2 + 20) })
          .attr("stroke", function(d){ return d.color })
          .style("stroke-width", 2)
          .style("fill", "none")
          .style("stroke-dasharray", function(d){ return d.dasharray });

        legend
          .selectAll('g.static_legend_text2')
          .data(static_legend_items)
          .enter()
          .append("g")
          .attr("class", "static_legend_text2")
          .append("text")
          .attr("x", width2 + 25)
          .attr("y", function(d,i){ return 20 + i*15 + 4})
          .style("fill", function(d){ return d.color})
          .text(function(d){ return d.name })
          .attr("text-anchor", "left")
          .style("font-size", "10px");

        update("Albania", selected_indicator2);

        var tooltip2 = d3.select("#covid-chart2").append("div")
          .attr("class", "tooltip2")
          .attr("style", "position: absolute; display: none;")

        var highlight2 = svg2
          .append("circle")
          .attr("class", "highlight2")
          .attr("r", 2.5)
          .attr("style","opacity:0;");

        svg2.append("rect")
          .attr("class", "overlay2")
          .attr("style","opacity:0;")
          .attr("width", width2)
          .attr("height", height2)
          .on("mousemove", function(){
            var mouse_position = d3.mouse(this);
            var x_pos = x.invert(mouse_position[0]);
            var y_pos = y.invert(mouse_position[1]);
            var matrix = this.getScreenCTM();
            var closest_year_distance = d3.min(current_data2, function(d){ return Math.abs(x_pos - d.year)});
            var closest_year = current_data2.filter(function(d){return Math.abs(x_pos - d.year) == closest_year_distance})[0].year;
            var current_data_by_year = current_data2.filter(function(d){ return d.year == closest_year });
            var closest_value_distance = d3.min(current_data_by_year, function(d){ return Math.abs(y_pos - d.value)});
            var closest_value = current_data_by_year.filter(function(d){return Math.abs(y_pos - d.value) == closest_value_distance})[0].value;
            var highlight_data = current_data_by_year.filter(function(d){ return d.value == closest_value});
            tooltip2
              .attr("style",
              "position: absolute;display: block;background-color:rgba(255,255,255,0.8);" +
              "top:" + (d3.event.clientY - matrix.f + margin2.top + height2*0.08) + "px;" +
              "left:" + (d3.event.clientX - matrix.e + margin2.left) + "px;"
            ).html(
              "<p><b>Year:</b> " + highlight_data[0].year + "</p>" +
              (highlight_data[0].estimate == "TRUE" ? ("<p><b>Estimate:</b> " + (highlight_data[0].covid == "TRUE" ? "After Covid-19": "Before Covid-19") + "</p>") : "") +
              "<p><b>Poverty type:</b> " + highlight_data[0].povtype + "</p>" +
              "<p><b>Value:</b> " + valueFormatAccurate(highlight_data[0].value) + "</p>"
            )
            highlight2
              .data(highlight_data)
              .attr("cx", function(d){return x(d.year)})
              .attr("cy", function(d){return y(d.value)})
              .attr("fill", function(d){return d.covid == "TRUE" ? d3.rgb(myColor(d.povtype)).darker() : myColor(d.povtype) })
              .attr("style","opacity:1;");
          })
          .on('mouseout', function(){
            tooltip2
              .attr("style", "position: absolute; display: none;")
            highlight2
              .attr("style","opacity:0;");
          });

    })
    // end chart 2
    // start chart 3

    var selected_country3 = "";
    var selected_indicator3 = "";
    var selected_demographic_category3 = "";
    var current_data3 = [];

    // set the dimensions and margins of the graph
    var margin3 = {top: 10, right: 220, bottom: 50, left: 80},
        width3 = 800 - margin3.left - margin3.right,
        height3 = 300 - margin3.top - margin3.bottom;

    // append the svg object to the body of the page
    var svg3 = d3.select("#covid-chart3")
      .append("svg")
        .attr('preserveAspectRatio', 'xMinYMin meet')
        .attr("viewBox", "0 0 " + (width3 + margin3.left + margin3.right) + " " + (height3 + margin3.top + margin3.bottom))
        .attr("style", "background-color: white;")
      .append("g")
        .attr("transform",
              "translate(" + margin3.left + "," + margin3.top + ")");

    var legend = svg3
      .append("g")
      .attr("transform","translate(30, 0)");

    legend
      .append("rect")
      .attr("x", width3 - 10)
      .attr("y", 0)
      .attr("width", margin3.right - 40)
      .attr("height", height3)
      .attr("fill", "#f8f7f8")


    //Read the data
    d3.csv("../survey-vis/all_survey.csv", function(data) {

        var allCountries = d3.map(data, function(d){return(d.name)}).keys();
        var allIndicators = d3.map(data, function(d){return(d.indicator)}).keys();
        var allDemographicCategories = d3.map(data, function(d){return(d.demographic_category)}).keys();

        d3.select("#countrySelectCovid3")
          .selectAll('myOptions')
         	.data(allCountries)
          .enter()
        	.append('option')
          .text(function (d) { return d; })
          .attr("value", function (d) { return d; });
        d3.select("#indicatorSelectCovid3")
          .selectAll('myOptions')
         	.data(allIndicators)
          .enter()
        	.append('option')
          .text(function (d) { return d; })
          .attr("value", function (d) { return d; });
        d3.select("#demographicSelectCovid3")
          .selectAll('myOptions')
         	.data(allDemographicCategories)
          .enter()
        	.append('option')
          .text(function (d) { return d; })
          .attr("value", function (d) { return d; });

        // A color scale: one color for each group
        var myColor = d3.scaleOrdinal()
          .range(["#0089cc", "#0c457b", "#f49b21", "#a85d00"]);

        // Add X axis
        var x = d3.scaleLinear()
          .domain(d3.extent(data, function(d) { return d.year; }))
          .range([ 0, width3 ]);
        var xAxis = d3.axisBottom(x).ticks(7).tickSizeOuter(0).tickFormat(d3.format("d"));
        svg3.append("g").attr("class","myXaxis3")
          .attr("transform", "translate(0," + height3 + ")")
          .call(xAxis);
        // Add X axis label:
        svg3.append("text")
            .attr("class","axis-title")
            .attr("id", "x-axis-title3")
            .attr("text-anchor", "middle")
            .attr("x", width3 / 2)
            .attr("y", height3 + margin3.top + 25)
            .text("Year");

        var formatPercent = d3.format(".0%");
        var formatPercentAccurate = d3.format(".2%");

        // Add Y axis
        var y = d3.scaleLinear()
          .domain([0, d3.max(data.filter(function(d){return allCountries[0]}), function(d) { return +d.value; })])
          .range([ height3, 0 ])
          .nice();
        var yAxis = d3.axisLeft().scale(y).ticks(7).tickSizeOuter(0).tickFormat(formatPercent);
        svg3.append("g").attr("class","myYaxis3")
          .call(yAxis);
        // add the Y gridlines
        var yGrid = d3.axisLeft().scale(y).ticks(7).tickSizeOuter(0).tickSize(-width3).tickFormat("");
        svg3.append("g")
            .attr("class", "yGrid3")
            .call(yGrid);
        // Y axis label:
        svg3.append("text")
            .attr("class","axis-title")
            .attr("id", "y-axis-title3")
            .attr("text-anchor", "end")
            .attr("transform", "rotate(-90)")
            .attr("y", -margin3.left+20)
            .attr("x", 0)
            .text("Percentage of population")

        var lines = svg3
          .append('g')
          .attr("class", "lines3");

        // A function that update the chart
        function update(selectedCountry, selectedIndicator, selectedDemographicCategory) {
          if(selectedCountry !== null){
            selected_country3 = selectedCountry;
          }
          if(selectedIndicator !== null){
            selected_indicator3 = selectedIndicator;
          }
          if(selectedDemographicCategory !== null){
            selected_demographic_category3 = selectedDemographicCategory;
          }

          svg3.selectAll('path.country_line3').remove();
          svg3.selectAll('g.legend_lines3').remove();
          svg3.selectAll('g.legend_text3').remove();
          svg3.selectAll('circle.highlight3').attr("style","opacity:0;");

          var country_dat = data.filter(function(d){return d.name==selected_country3 && d.indicator==selected_indicator3 &&  d.demographic_category==selected_demographic_category3});
          current_data3 = country_dat;
          var allDemographics = d3.map(country_dat, function(d){return(d.demographic)}).keys();

          if(country_dat.length == 0){
            d3.select("#x-axis-title3")
              .attr("x", width3 / 2)
              .attr("y", (height3 + margin3.top)/2)
              .text("No data available");
            d3.select("#y-axis-title3")
              .attr("style", "opacity:0");
          }else{
            d3.select("#x-axis-title3")
              .attr("x", width3 / 2)
              .attr("y", height3 + margin3.top + 25)
              .text("Year");
            d3.select("#y-axis-title3")
              .attr("style", "opacity:1");
          }

          if(allDemographics.length == 2){
            myColor.range(["#0089cc", "#f49b21"]);
          }else{
            myColor.range(["#0089cc", "#0c457b", "#f49b21", "#a85d00"]);
          };

          myColor.domain(allDemographics.sort().reverse());

          legend
            .selectAll('g.legend_lines3')
            .data(allDemographics)
            .enter()
            .append("g")
            .attr("class", "legend_lines3")
            .append("path")
            .attr("d", function(d, i){return "m " + width3 + " " + (20 + i*15) + " H " + (width3 + 20) })
            .attr("stroke", function(d){ return myColor(d) })
            .style("stroke-width", 2)
            .style("fill", "none");

          legend
            .selectAll('g.legend_text3')
            .data(allDemographics)
            .enter()
            .append("g")
            .attr("class", "legend_text3")
            .append("text")
            .attr("x", width3 + 25)
            .attr("y", function(d,i){ return 20 + i*15 + 4})
            .style("fill", function(d){ return myColor(d)})
            .text(function(d){ return d })
            .attr("text-anchor", "left")
            .style("font-size", "10px");

          for(var i = 0; i < allDemographics.length; i++){
            var demographic = allDemographics[i];
            var demographic_dat = country_dat.filter(function(d){return d.demographic==demographic});
            lines
              .append("path")
              .attr("class", "country_line3")
                .datum(demographic_dat)
                .attr("d", d3.line()
                  .x(function(d) { return x(d.year) })
                  .y(function(d) { return y(+d.value) })
                )
                .attr("stroke", function(d){ return myColor(demographic) })
                .style("stroke-width", 2)
                .style("fill", "none");
          };

          // Adjust X axis
          x.domain(d3.extent(country_dat, function(d) { return d.year; }));
          svg3.selectAll(".myXaxis3")
          .transition()
          .duration(1000)
          .call(xAxis);
          // Adjust y axis
          var ymax = d3.max(country_dat, function(d) { return +d.value; });
          if(ymax < 0.01){
            formatPercent = d3.format(".2%");
          }else if(ymax < 0.05){
            formatPercent = d3.format(".1%");
          }else{
            formatPercent = d3.format(".0%");
          };
          yAxis.tickFormat(formatPercent);
          y.domain([0, d3.max(country_dat, function(d) { return +d.value; })]).nice();
          svg3.selectAll(".myYaxis3")
          .transition()
          .duration(1000)
          .call(yAxis);
          svg3.selectAll(".yGrid3")
          .transition()
          .duration(1000)
          .call(yGrid);

          svg3.selectAll('path.country_line3')
          .transition()
          .duration(1000)
          .attr("d", d3.line()
            .x(function(d) { return x(d.year) })
            .y(function(d) { return y(+d.value) })
          )
        }

        // When the button is changed, run the updateChart function
        d3.select("#countrySelectCovid3").on("change", function(d) {
            // recover the option that has been chosen
            var selectedOption = d3.select(this).property("value");
            // run the updateChart function with this selected option
            update(selectedOption, selected_indicator3, selected_demographic_category3);
        });
        d3.select("#indicatorSelectCovid3").on("change", function(d) {
            // recover the option that has been chosen
            var selectedOption = d3.select(this).property("value");
            // run the updateChart function with this selected option
            update(selected_country3, selectedOption, selected_demographic_category3);
        });
        d3.select("#demographicSelectCovid3").on("change", function(d) {
            // recover the option that has been chosen
            var selectedOption = d3.select(this).property("value");
            // run the updateChart function with this selected option
            update(selected_country3, selected_indicator3, selectedOption);
        });

        update(allCountries[0], allIndicators[0], allDemographicCategories[0]);

        var tooltip3 = d3.select("#covid-chart3").append("div")
          .attr("class", "tooltip3")
          .attr("style", "position: absolute; display: none;")

        var highlight3 = svg3
          .append("circle")
          .attr("class", "highlight3")
          .attr("r", 2.5)
          .attr("style","opacity:0;");

        svg3.append("rect")
          .attr("class", "overlay3")
          .attr("style","opacity:0;")
          .attr("width", width3)
          .attr("height", height3)
          .on("mousemove", function(){
            var mouse_position = d3.mouse(this);
            var x_pos = x.invert(mouse_position[0]);
            var y_pos = y.invert(mouse_position[1]);
            var matrix = this.getScreenCTM();
            var closest_year_distance = d3.min(current_data3, function(d){ return Math.abs(x_pos - d.year)});
            var closest_year = current_data3.filter(function(d){return Math.abs(x_pos - d.year) == closest_year_distance})[0].year;
            var current_data_by_year = current_data3.filter(function(d){ return d.year == closest_year });
            var closest_value_distance = d3.min(current_data_by_year, function(d){ return Math.abs(y_pos - d.value)});
            var closest_value = current_data_by_year.filter(function(d){return Math.abs(y_pos - d.value) == closest_value_distance})[0].value;
            var highlight_data = current_data_by_year.filter(function(d){ return d.value == closest_value});
            tooltip3
              .attr("style",
              "position: absolute;display: block;background-color:rgba(255,255,255,0.8);" +
              "top:" + (d3.event.clientY - matrix.f + margin3.top + height3*0.08) + "px;" +
              "left:" + (d3.event.clientX - matrix.e + margin3.left) + "px;"
            ).html(
              "<p><b>Year:</b> " + highlight_data[0].year + "</p>" +
              "<p><b>Demographic:</b> " + highlight_data[0].demographic + "</p>" +
              "<p><b>Value:</b> " + formatPercentAccurate(highlight_data[0].value) + "</p>"
            )
            highlight3
              .data(highlight_data)
              .attr("cx", function(d){return x(d.year)})
              .attr("cy", function(d){return y(d.value)})
              .attr("fill", function(d){return myColor(d.demographic)})
              .attr("style","opacity:1;");
          })
          .on('mouseout', function(){
            tooltip3
              .attr("style", "position: absolute; display: none;")
            highlight3
              .attr("style","opacity:0;");
          });

    })

    // end chart 3


    </script>

    </main>




<footer role="contentinfo" class="footer">
	<div class="row">
		<div class="l-footer">
			<div class="l-footer__col">


        <h4 class="footer__title">Sign up for our newsletter to receive regular news and updates</h4>
        <a href="https://us11.list-manage.com/subscribe?u=a829237ca0cf1470615c7f059&amp;id=ce30e2af0f" class="button">Subscribe here</a>



			</div>




        <div class="l-footer__col">
            <h4 class="footer__title">Get around</h4>


                <ul class="footer__list">

                        <li><a href="https://devinit.org/who-we-are/?nav=footer">Who we are</a></li>

                        <li><a href="https://devinit.org/what-we-do/?nav=footer">What we do</a></li>

                        <li><a href="https://devinit.org/how-we-work/?nav=footer">How we work</a></li>

                        <li><a href="https://devinit.org/resources/?nav=footer">Resources</a></li>

                        <li><a href="https://devinit.org/data/?nav=footer">Data</a></li>

                        <li><a href="https://devinit.org/blog/?nav=footer">Blog</a></li>

                        <li><a href="https://devinit.org/work-for-us/?nav=footer">Work for us</a></li>



                </ul>



        </div>

        <div class="l-footer__col">
            <h4 class="footer__title">Get in touch</h4>


                <ul class="footer__list">




                            <li><a href="https://devinit.org/contact-us/?nav=footer">Contact us</a></li>



                            <li><a href="https://devinit.org/media-centre/?nav=footer">Media centre</a></li>


                </ul>



        </div>

        <div class="l-footer__col">
            <h4 class="footer__title">Policies and statements</h4>


                <ul class="footer__list">




                            <li><a href="http://devinit.org/documents/664/Modern_slavery_and_human_trafficking_statement.pdf?nav=footer">Modern slavery and human trafficking statement</a></li>



                            <li><a href="http://devinit.org/documents/666/Privacy_and_cookie_policy.pdf?nav=footer">GDPR and Privacy notice</a></li>



                            <li><a href="http://devinit.org/documents/663/Responsible_employer_and_business_ethics_statement.pdf?nav=footer">Responsible employer and business ethics statement</a></li>



                            <li><a href="https://devinit.org/documents/811/Income_Acceptance_Policy.pdf?nav=footer">Income acceptance policy</a></li>


                </ul>



        </div>



		</div>


<div class="footer__meta">
  <div class="footer__meta-copy footer__meta-copy--major"><div class="rich-text"><p>Content produced by Development Initiatives is licensed under a <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution BY-NC-ND 4.0 International license</a>, unless stated otherwise on an image or page.</p></div></div>
    <div class="footer__meta-copy"><div class="rich-text"><p>Development Initiatives is the trading name of Development Initiatives Poverty Research Ltd, registered in England and Wales, Company No. 06368740; DI International Ltd, registered in England and Wales, Company No. 5802543, Registered Address: North Quay House, Quay Side, Temple Back, Bristol, BS1 6FL, UK; and Development Initiatives Poverty Research America Inc. (a 501(C)3 company registered in the state of Delaware with the registration number 5737757), Registered Address: 1209 Orange Street, Wilmington, New Castle County, Delaware 19801.</p></div></div>
</div>

	</div>
</footer>


  </div>



<script src="https://devinit.org/assets/js/app.bundle.69790ff789ef.js"></script>







</body></html>
